<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Stress Levels</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
        }
        #mynetwork {
            width: 100%;
            height: 600px;
            border: 1px solid lightgray;
            background-color: white;
        }
        .btn-group {
            text-align: center;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 0 10px;
            cursor: pointer;
        }
    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
</head>
<body>

    <h1>Team Stress Levels</h1>
    <div class="btn-group">
        <button onclick="visualizeByLocation()">By Location</button>
        <button onclick="visualizeByTeam()">By Team</button>
    </div>
    <div id="mynetwork"></div>

    <script>
        const mockData = {
            "New York City": {
                "Investment Management": 3,
                "Investment Banking": 4,
                "Emerging Technology": 2,
                "Global & Private Market": 3,
                "Mid- & Back-Office": 1
            },
            "London": {
                "Investment Management": 2,
                "Investment Banking": 5,
                "Emerging Technology": 3,
                "Global & Private Market": 4,
                "Mid- & Back-Office": 2
            },
            "Hong Kong": {
                "Global & Private Market": 4
            }
        };

        const createNodesAndEdges = (data) => {
            const nodes = [];
            const edges = [];
            let nodeId = 0;

            for (const office in data) {
                nodes.push({ id: nodeId++, label: office, level: 0 });
                for (const team in data[office]) {
                    nodes.push({ id: nodeId++, label: team + " (" + data[office][team] + ")", level: 1 });
                    edges.push({ from: nodeId - 2, to: nodeId - 1 });
                }
            }
            return { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
        };

        const visualizeByLocation = () => {
            const { nodes, edges } = createNodesAndEdges(mockData);
            renderGraph(nodes, edges);
        };

        const visualizeByTeam = () => {
            const teamData = {};
            for (const office in mockData) {
                for (const team in mockData[office]) {
                    if (!teamData[team]) {
                        teamData[team] = 0;
                    }
                    teamData[team] += mockData[office][team];
                }
            }

            const nodes = [];
            const edges = [];
            let nodeId = 0;

            for (const team in teamData) {
                nodes.push({ id: nodeId++, label: team + " (" + teamData[team] + ")", level: 0 });
            }

            for (let i = 0; i < nodes.length; i++) {
                const officeNodes = Object.keys(mockData).map((office, index) => {
                    return { id: nodeId++, label: office, level: 1 };
                });

                for (const officeNode of officeNodes) {
                    nodes.push(officeNode);
                    edges.push({ from: i, to: nodeId - 1 });
                }
            }

            renderGraph(new vis.DataSet(nodes), new vis.DataSet(edges));
        };

        const renderGraph = (nodes, edges) => {
            const container = document.getElementById('mynetwork');
            const data = { nodes, edges };
            const options = {
                layout: {
                    hierarchical: {
                        direction: "UD",
                    }
                },
                physics: false,
                edges: {
                    arrows: 'to'
                }
            };
            new vis.Network(container, data, options);
        };

        // Initial visualization
        visualizeByLocation();
    </script>
    
</body>
</html>
